<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Delft3D Project Example</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
        <link rel="stylesheet" href="https://unpkg.com/leaflet-compass/dist/leaflet-compass.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.css">
        <link rel="stylesheet" href="static/temp_style.css?v=12">
        <link rel="icon" type="image/png" href="/images/Logo.png">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <!-- Add the header -->
        <header class="header">
            <h1>Delft3D Project Example</h1>
        </header>
        <!-- Add the menu button -->
        <button type="button" id="menuBtn" onclick="toggleMenu()">
            <img src="images/menu.png" width="60px" alt="Menu">
        </button>
        <!-- Add the control panel -->
        <div id="right-side-controls">
            <button type="button" id="custom_compass_btn">
                <img src="images/compass.png?v=1"alt="Compass">
            </button>
            <!--Add Color Legend-->
            <div class="custom-colorbar">
                <div class="colorbar-wrapper">
                    <div class="colorbar-title" id="colorbar-title">Legend</div>
                    <div class="colorbar-gradient" id="colorbar-gradient"></div>
                    <div class="colorbar-labels">
                        <div id="colorbar-max">max</div>
                        <div id="colorbar-min">min</div>
                    </div>
                </div>
            </div>
        </div>  
        
        <!-- Add the left side-bar menu -->
        <div id="offCanvasMenu">
            <a onclick="history.back()">Home</a>
            <a onclick="openProjectSummary('summary.json')">Project Summary</a>
            <div class="menu-item-with-submenu">
                <a class="menu-link">Points <span class="arrow">&#x25B8;</span></a>
                <div class="submenu">
                    <label class="submenu-label">
                        <input type="checkbox" onchange="this.checked ? loadData('stations.geojson', 'stations') : hideComponent('stations')"> Stations</input>
                    </label> <br>
                    <label class="submenu-label">
                        <input type="checkbox" onchange="this.checked ? makeQuery('point') : hideQuery('point')"> Query Point</input>
                    </label>
                </div>
            </div>
            <div class="menu-item-with-submenu">
                <a class="menu-link">Profile <span class="arrow">&#x25B8;</span></a>
                <div class="submenu">
                    <label class="submenu-label">
                        <input type="checkbox" onchange="this.checked ? loadData('cross_sections.geojson', 'cross_sections') : hideComponent('cross_sections')"> Cross-sections</input>
                    </label> <br>
                    <label class="submenu-label">
                        <input type="checkbox" onchange="this.checked ? makeQuery('path') : hideQuery('path')"> Query Profile</input>
                    </label>
                </div>
            </div>
            <div class="menu-item-with-submenu">
                <a class="menu-link">Global Parameters <span class="arrow">&#x25B8;</span></a>
                <div class="submenu">
                    <!-- Hydrodynamics -->
                    <div class="menu-item-with-submenu_1">
                        <a class="menu-link_1">â€¢ Hydrodynamics <span class="arrow_1">&#x25B8;</span></a>
                        <div class="submenu_1">
                            <a onclick="loadData('waterlevel.json', 'waterlevel', 'Water Level (m)')">â€¢ Water Level</a>
                            <a onclick="loadData('waterdepth.json', 'waterdepth', 'Water Depth (m)')">â€¢ Water Depth</a>
                        </div>
                    </div>
                    <!-- Water Quality
                    <div class="menu-item-with-submenu_1">
                        <a class="menu-link_1">â€¢ Water Quality <span class="arrow_1">&#x25B8;</span></a>
                        <div class="submenu_1">
                            <a onclick="loadData('temperature.json', 'waterlevel', 'Temperature (Â°C)')">â€¢ Temperature</a>



                        </div>
                    </div> -->
                    <!-- Water Balance -->
                    <div class="menu-item-with-submenu_1">
                        <a class="menu-link_1">â€¢ Water Balance <span class="arrow_1">&#x25B8;</span></a>
                        <div class="submenu_1">
                            <a onclick="loadData('waterbalance_totalvolume.json', 'waterbalance_totalvolume', 'Total Volume (m<sup>3</sup>)')">â€¢ Total Volume</a>
                            <a onclick="loadData('waterbalance_storage.json', 'waterbalance_storage', 'Storage (m<sup>3</sup>)')">â€¢ Storage</a>
                            <a onclick="loadData('waterbalance_boundariesin.json', 'waterbalance_boundariesin', 'Inflow (Boundaries) (m<sup>3</sup>)')">â€¢ Inflow from Boundaries</a>
                            <a onclick="loadData('waterbalance_boundariesout.json', 'waterbalance_boundariesout', 'Outflow (Boundaries) (m<sup>3</sup>)')">â€¢ Outflow from Boundaries</a>
                            <a onclick="loadData('waterbalance_boundariestotal.json', 'waterbalance_boundariestotal', 'Total (Boundaries) (m<sup>3</sup>)')">â€¢ Total from Boundaries</a>
                            <a onclick="loadData('waterbalance_precipitation.json', 'waterbalance_precipitation', 'Total (Precipitation) (m<sup>3</sup>)')">â€¢ Total from Precipitation</a>
                            <a onclick="loadData('waterbalance_evaporation.json', 'waterbalance_evaporation', 'Total (Precipitation) (m<sup>3</sup>)')">â€¢ Total from Evaporation</a>
                            <a onclick="loadData('waterbalance_sourcesink.json', 'waterbalance_sourcesink', 'Source/Sink (m<sup>3</sup>)')">â€¢ Source/Sink</a>
                            <a onclick="loadData('waterbalance_groundwaterin.json', 'waterbalance_groundwaterin', 'Inflow (Groundwater) (m<sup>3</sup>)')">â€¢ Inflow from Groundwater</a>
                            <a onclick="loadData('waterbalance_groundwaterout.json', 'waterbalance_groundwaterout', 'Outflow (Groundwater) (m<sup>3</sup>)')">â€¢ Outflow from Groundwater</a>
                            <a onclick="loadData('waterbalance_groundwatertotal.json', 'waterbalance_groundwatertotal', 'Total (Groundwater) (m<sup>3</sup>)')">â€¢ Total from Groundwater</a>
                            <a onclick="loadData('waterbalance_precipitationonground.json', 'waterbalance_precipitationonground', 'Precipitation on Ground (m<sup>3</sup>)')">â€¢ Precipitation on Ground</a>
                            <a onclick="loadData('waterbalance_volumeerror.json', 'waterbalance_volumeerror', 'Volume Error (%)')">â€¢ Volume Error</a>
                        </div>
                    </div>
                    <!-- Meteorological -->
                    <div class="menu-item-with-submenu_1">
                        <a class="menu-link_1">â€¢ Meteorological <span class="arrow_1">&#x25B8;</span></a>
                        <div class="submenu_1">
                            <a onclick="loadData('total_energy.json', 'total_energy', 'Total Energy (W/m<sup>2</sup>)')">â€¢ Total Energy</a>
                            <a onclick="loadData('precipitation.json', 'precipitation', 'Precipitation (mm)')">â€¢ Precipitation</a>
                            <a onclick="loadData('wind.json', 'wind', 'Wind (m/s)')">â€¢ Wind</a>
                            <a onclick="loadData('air_temperature.json', 'air_temperature', 'Air Temperature (Â°C)')">â€¢ Air Temperature</a>
                            <a onclick="loadData('relative_humidity.json', 'relative_humidity', 'Relative Humidity (%)')">â€¢ Relative Humidity</a>
                            <a onclick="loadData('solar_radiation.json', 'solar_radiation', 'Solar Radiation (W/m<sup>2</sup>)')">â€¢ Solar Radiation</a>
                            <a onclick="loadData('evaporation.json', 'evaporation', 'Evaporation (mm)')">â€¢ Evaporation</a>
                            <a onclick="loadData('longwave_radiation.json', 'longwave_radiation', 'Longwave Radiation (W/m<sup>2</sup>)')">â€¢ Longwave Radiation</a>
                            <a onclick="loadData('frequency_evaporation.json', 'frequency_evaporation', 'Evaporation Frequency (%)')">â€¢ Evaporation Frequency</a>
                            <a onclick="loadData('frequency_convection.json', 'frequency_convection', 'Convection Frequency (%)')">â€¢ Convection Frequency</a>
                            <a onclick="loadData('cloud_cover.json', 'cloud_cover', 'Cloud Cover (%)')">â€¢ Cloud Cover</a>
                        </div>
                    </div>
                </div>
            </div>            
        </div>

        <!-- Add the map -->
        <div id="map_container">
            <div id="leaflet_map"></div>
            <iframe id="iframe_map" title="Map"></iframe>
            <!-- Add time slider -->
            <div id="time-controls">
                <button id="play-btn">â–¶ Play</button>
                <div id="time-slider"></div>
                <!-- <button id="export-video-btn">ðŸ’¾ Export Video</button>
                <div id="export-progress-container" style="display:none; margin-top:10px; width: 100%;">
                <div id="export-progress-bar" style="width: 0%; height: 8px; background: limegreen;
                    border-radius: 4px; transition: width 0.2s ease;"></div>
                </div> -->
            </div>
            <div id="loadingOverlay">
                <div class="loading-text">Processing Data. Please wait...</div>
                <div class="spinner"></div>
            </div>
        </div>

        <!-- Add the right side-bar menu -->
        <div id="infoPanel">
            <div id="infoPanelHeader">Map Properties<span id="arrowToggle">â–²</span></div>
            <div class="menu-item-with-submenu">
                <a class="menu-link">Hydrodynamics <span class="arrow">&#x25B8;</span></a>
                <div class="submenu">
                    <a onclick="loadData('temperature_toplayer.geojson', 'mesh2d_tem1', 'Temperature (Â°C)')">â€¢ Temperature (Top Layer)</a>
                    <a onclick="loadData('salinity_toplayer.geojson', 'mesh2d_sa1', 'Salinity (PSU)')">â€¢ Sanlinity (Top Layer)</a>
                    <a onclick="loadData('contaminant_toplayer.geojson', 'mesh2d_contaminant', 'Contaminant (Î¼g/L)')">â€¢ Contaminant (Top Layer)</a>
                    <a onclick="loadData('waterlevel_dynamic.geojson', 'mesh2d_s1', 'Water Surface Level (m)')">â€¢ Water Surface Level</a>
                    <a onclick="loadData('waterdepth_dynamic.geojson', 'mesh2d_waterdepth', 'Depth Water Level (m)')">â€¢ Depth Water Level</a>
                    <a onclick="loadData('depth_velocity.geojson', 'depth_velocity', 'Depth-averaged Velocity (m/s)')">â€¢ Depth-averaged Velocity</a>
                    
                    
                    
                    <!-- <a onclick="loadData('bed_shear_stress.json', 'bed_shear_stress', 'Bed Shear Stress (kPa)')">â€¢ Bed Shear Stress</a> -->
                    <!-- <a >â€¢ Velocity (2D)</a>
                    <a >â€¢ Velocity (3D)</a>
                    <a >â€¢ Sediment Thickness</a> -->
                </div>
            </div>



            <div class="menu-item-with-submenu">
                <a class="menu-link">Water Quality <span class="arrow">&#x25B8;</span></a>
                <div class="submenu">
                    <a onclick="loadData('temperature_multilayers.geojson', 'mesh2d_tem1', 'Temperature (Â°C)')">â€¢ Temperature</a>
                    <a onclick="loadData('salinity_multilayers.geojson', 'mesh2d_sa1', 'Salinity (PSU)')">â€¢ Salinity</a>
                    <a onclick="loadData('contaminant_multilayers.geojson', 'mesh2d_contaminant', 'Contaminant (Î¼g/L)')">â€¢ Contaminant</a>
                </div>
            </div>

            <div class="menu-item-with-submenu">
                <a class="menu-link">Static <span class="arrow">&#x25B8;</span></a>
                <div class="submenu">
                    <a onclick="loadData('depth_static.geojson', 'depth', 'Depth (m)')">â€¢ Bed Depth</a>
                    <!-- <a >â€¢ Cell Size</a> -->
                </div>
            </div>
            
            <div id="infoDetails">
                <div id="infoDetailsHeader">Point Info</div>
                <div id="infoDetailsContent"></div>
            </div>
        </div>

        <!-- Add a floating summary window -->
        <div id="infoWindow">
            <div id="infoHeader">Summary<span onclick="openProjectSummary('summary.json')" id="closeInfoBtn">Ã—</span></div>
            <div id="infoContent"></div>
        </div>
        
        <!-- Add a floating plot window -->
        <div id="plotWindow">
            <div id="plotHeader">Plot Window<span onclick="openPlotChart()" id="closePlotBtn">Ã—</span></div>
            <div style="padding: 0 8px;">
                <button type="button" id="downloadBtn" onclick="viewData()">View Data</button>
                <button type="button" id="downloadExcel" onclick="saveToExcel()">Download Excel</button>
            </div>
            <div id="plotContainer">
                <div id="myChart"></div>
            </div>
        </div>
    </body>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-compass/dist/leaflet-compass.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.26.1.min.js"></script>
    <script src="https://unpkg.com/leaflet.vectorgrid@1.3.0/dist/Leaflet.VectorGrid.bundled.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/antimatter15/whammy/whammy.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Load the newest version of the script -->
    <script>
        const script = document.createElement('script');
        script.src = `static/temp_script.js?v=${Date.now()}`;
        document.body.appendChild(script);
    </script>
</html>